{
  "allowRemoteResourceManagement": true,
  "policyEnforcementMode": "ENFORCING",
  "resources": [
    {
      "name": "Organizations Resource",
      "uri": "/organizations/*",
      "type": "http://openfact.com/organizations/*",
      "scopes": [
        {
          "name": "urn:openfact.com:scopes:organizations:view"
        },
        {
          "name": "urn:openfact.com:scopes:organizations:extension:view"
        },
        {
          "name": "urn:openfact.com:scopes:organizations:extension:manage"
        }
      ]
    },
    {
      "name": "Admin Organizations Resource",
      "uri": "/admin/organizations/*",
      "type": "http://openfact.com/admin/organizations/*",
      "scopes": [
        {
          "name": "urn:openfact.com:scopes:admin:organization:view"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:create"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:manage"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:delete"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:document:view"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:document:manage"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:file:view"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:file:manage"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:event:view"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:event:manage"
        }
      ]
    },
    {
      "name": "Admin Server Info Resource",
      "uri": "/admin/serverinfo",
      "type": "http://openfact.com/admin/serverinfo",
      "scopes": [
        {
          "name": "urn:openfact.com:scopes:admin:serverinfo:view"
        }
      ]
    }
  ],
  "policies": [
    {
      "name": "Only Admin Realm Role Policy",
      "description": "Defines that only Admin users can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin\",\"required\":true}]"
      }
    },
    {
      "name": "Only Admin Organization Realm Role Policy",
      "description": "Defines that only Admin-Organization users can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin-organization\",\"required\":true}]"
      }
    },
    {
      "name": "Any Realm Role Policy",
      "description": "Defines that only users who have at least one Realm Role can do something.",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin\",\"required\":false},{\"id\":\"admin-organization\",\"required\":false},{\"id\":\"organization-user\",\"required\":false}]"
      }
    },

    {
      "name": "View Organization Permission",
      "description": "A policy that allows to get organization information to any valid roles.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Any Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:view\"]"
      }
    },
    {
      "name": "Create Organization Permission",
      "description": "A policy that only allows the admin to create organizations.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Admin Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:create\"]"
      }
    },
    {
      "name": "Update Organization Permission",
      "description": "A policy that only allows the admin on organization to update organization.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "AFFIRMATIVE",
      "config": {
        "applyPolicies": "[\"Only Admin Realm Role Policy\",\"Only Admin Organization Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:manage\"]"
      }
    },
    {
      "name": "Delete Organization Permission",
      "description": "A policy that only allows the admin on master organization to delete organizations.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Admin Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:delete\"]"
      }
    },
    {
      "name": "Admin Server Info Permission",
      "description": "Defines who is allowed to manage Sever Info",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Admin Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:serverinfo:view\"]"
      }
    },


    {
      "name": "Only View Documents Client Role Policy",
      "description": "Defines that only view-documents client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"view-documents\"}]"
      }
    },
    {
      "name": "Only Manage Documents Client Role Policy",
      "description": "Defines that only manage-documents client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"manage-documents\"}]"
      }
    },
    {
      "name": "Only View Files Client Role Policy",
      "description": "Defines that only view-files client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"view-files\"}]"
      }
    },
    {
      "name": "Only Manage Files Client Role Policy",
      "description": "Defines that only manage-files client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"manage-files\"}]"
      }
    },
    {
      "name": "Only View Events Client Role Policy",
      "description": "Defines that only view-events client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"view-events\"}]"
      }
    },
    {
      "name": "Only Manage Events Client Role Policy",
      "description": "Defines that only manage-events client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"manage-events\"}]"
      }
    },
    {
      "name": "Only View Extensions Client Role Policy",
      "description": "Defines that only view-extensions client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"view-extensions\"}]"
      }
    },
    {
      "name": "Only Manage Extensions Client Role Policy",
      "description": "Defines that only manage-extensions client role can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[]",
        "roles": "[{\"id\":\"manage-extensions\"}]"
      }
    },

    {
      "name": "View Documents Permission",
      "description": "Defines who is allowed to view documents",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only View Documents Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:document:view\"]"
      }
    },
    {
      "name": "Manage Documents Permission",
      "description": "Defines who is allowed to manage documents",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Manage Documents Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:document:manage\"]"
      }
    },
    {
      "name": "View Files Permission",
      "description": "Defines who is allowed to view files",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only View Files Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:file:view\"]"
      }
    },
    {
      "name": "Manage Files Permission",
      "description": "Defines who is allowed to manage debit notes",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Manage Files Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:file:manage\"]"
      }
    },
    {
      "name": "View Events Permission",
      "description": "Defines who is allowed to view events",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only View Events Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:event:view\"]"
      }
    },
    {
      "name": "Manage Events Permission",
      "description": "Defines who is allowed to manage events",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Manage Events Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:event:manage\"]"
      }
    },
    {
      "name": "View Extensions Permission",
      "description": "Defines who is allowed to view extensions",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only View Extensions Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:organizations:extension:view\"]"
      }
    },
    {
      "name": "Manage Extensions Permission",
      "description": "Defines who is allowed to manage extensions",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Manage Extensions Client Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:organizations:extension:manage\"]"
      }
    }
  ],
  "scopes": [
    {
      "name": "urn:openfact.com:scopes:organizations:view"
    },
    {
      "name": "urn:openfact.com:scopes:organizations:extension:view"
    },
    {
      "name": "urn:openfact.com:scopes:organizations:extension:manage"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:view"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:create"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:manage"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:delete"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:document:view"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:document:manage"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:file:view"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:file:manage"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:event:view"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:event:manage"
    }
  ]
}