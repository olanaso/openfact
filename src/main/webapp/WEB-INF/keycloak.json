{
  "realm": "${sso.realm:openfact}",
  "bearer-only": true,
  "auth-server-url": "${sso.auth.server.url:http://localhost:8081/auth}",
  "ssl-required": "external",
  "resource": "${sso.clientId:openfact-restful-api}",
  "credentials": {
    "secret": "${sso.clientSecret:secret}"
  },
  "enable-cors": true,
  "cors-exposed-headers": "WWW-Authenticate",
  "policy-enforcer": {
    "user-managed-access": {},
    "paths": [
      {
        "path": "/profile"
      },
      {
        "path": "/serverinfo"
      },
      {
        "path": "/pe/sunat/*"
      },
      {
        "path": "/users/*",
        "methods": [
          {
            "method": "POST",
            "scopes": [
              "urn:openfact.com:scopes:user:create"
            ]
          },
          {
            "method": "GET",
            "scopes": [
              "urn:openfact.com:scopes:user:view"
            ]
          }
        ]
      },
      {
        "name": "User Resource",
        "path": "/users/{id}",
        "methods": [
          {
            "method": "GET",
            "scopes": [
              "urn:openfact.com:scopes:user:view"
            ]
          },
          {
            "method": "PUT",
            "scopes": [
              "urn:openfact.com:scopes:user:edit"
            ]
          },
          {
            "method": "DELETE",
            "scopes": [
              "urn:openfact.com:scopes:user:delete"
            ]
          }
        ]
      },
      {
        "name": "Organization Resource",
        "path": "/organizations/*",
        "methods": [
          {
            "method": "GET",
            "scopes": [
              "urn:openfact.com:scopes:organization:view"
            ]
          },
          {
            "method": "POST",
            "scopes": [
              "urn:openfact.com:scopes:organization:view"
            ]
          }
        ]
      },
      {
        "name": "Organization Resource",
        "path": "/organizations/{id}",
        "methods": [
          {
            "method": "GET",
            "scopes": [
              "urn:openfact.com:scopes:organization:manage"
            ]
          },
          {
            "method": "PUT",
            "scopes": [
              "urn:openfact.com:scopes:organization:manage"
            ]
          },
          {
            "method": "DELETE",
            "scopes": [
              "urn:openfact.com:scopes:organization:delete"
            ]
          }
        ]
      },
      {
        "name": "Organization Resource",
        "path": "/organizations/{id}/*",
        "methods": [
          {
            "method": "GET",
            "scopes": [
              "urn:openfact.com:scopes:organization:manage"
            ]
          },
          {
            "method": "POST",
            "scopes": [
              "urn:openfact.com:scopes:organization:manage"
            ]
          },
          {
            "method": "PUT",
            "scopes": [
              "urn:openfact.com:scopes:organization:manage"
            ]
          },
          {
            "method": "DELETE",
            "scopes": [
              "urn:openfact.com:scopes:organization:delete"
            ]
          }
        ]
      }
    ]
  }
}