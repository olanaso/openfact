{
  "allowRemoteResourceManagement": true,
  "policyEnforcementMode": "ENFORCING",
  "resources": [
    {
      "name": "Admin Organizations Resource",
      "uri": "/admin/organizations/*",
      "type": "http://openfact.com/admin/organizations/*",
      "scopes": [
        {
          "name": "urn:openfact.com:scopes:admin:organization:view"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:create"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:manage"
        },
        {
          "name": "urn:openfact.com:scopes:admin:organization:delete"
        }
      ]
    }
  ],
  "policies": [
    {
      "name": "Only Admin Realm Role Policy",
      "description": "Defines that only Admin users can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin\",\"required\":true}]"
      }
    },
    {
      "name": "Only Admin Organization Realm Role Policy",
      "description": "Defines that only Admin-Organization users can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin-organization\",\"required\":true}]"
      }
    },
    {
      "name": "Any Realm Role Policy",
      "description": "Defines that only users who have at least one Realm Role can do something.",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin\",\"required\":false},{\"id\":\"admin-organization\",\"required\":false},{\"id\":\"organization-user\",\"required\":false}]"
      }
    },

    {
      "name": "View Organization Permission",
      "description": "A policy that allows to get organization information to any valid roles.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Any Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:view\"]"
      }
    },
    {
      "name": "Create Organization Permission",
      "description": "A policy that only allows the admin to create organizations.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Admin Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:create\"]"
      }
    },
    {
      "name": "Update Organization Permission",
      "description": "A policy that only allows the admin on organization to update organization.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "AFFIRMATIVE",
      "config": {
        "applyPolicies": "[\"Only Admin Organization Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:manage\"]"
      }
    },
    {
      "name": "Delete Organization Permission",
      "description": "A policy that only allows the admin on master organization to delete organizations.",
      "type": "scope",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "applyPolicies": "[\"Only Admin Realm Role Policy\"]",
        "scopes": "[\"urn:openfact.com:scopes:admin:organization:delete\"]"
      }
    }
  ],
  "scopes": [
    {
      "name": "urn:openfact.com:scopes:admin:organization:view"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:create"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:manage"
    },
    {
      "name": "urn:openfact.com:scopes:admin:organization:delete"
    }
  ]
}